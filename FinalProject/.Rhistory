library(xlsx)
read.xlsx("OnlineRetail.xlsx")
read.xlsx("OnlineRetail.xlsx", sheetIndex = 1)
read.xlsx("OnlineRetail.xlsx", sheetIndex = 1)
read.xlsx2("OnlineRetail.xlsx", sheetIndex = 1)
read.csv("OnlineRetail.csv", headers = TRUE, stringsAsFactors = FALSE)
read.csv("OnlineRetail.csv", stringsAsFactors = FALSE)
retail.data <- read.csv("OnlineRetail.csv", stringsAsFactors = FALSE)
str(retail.data)
retail.data[, factor.cols] <- lapply(retail.data[factor.cols], as.factor)
# Set factors
factor.cols <- c("InvoiceNo", "StockCode", "CustomerID", "Country")
retail.data[, factor.cols] <- lapply(retail.data[factor.cols], as.factor)
str(retail.data)
levels(retail.data$Country)
View(retail.data)
zz <- retail.data %>% filter(CustomerID == 15311)
library(dplyr)
zz <- retail.data %>% filter(CustomerID == 15311)
zz
View(zz)
bank.data <- read.table("bank-additional-full.csv",header=TRUE,sep=";")
View(bank.data)
str(bank.data)
View(retail.data)
retail.data <- read.csv("data/OnlineRetail.csv", stringsAsFactors = FALSE)
library(dplyr)
str(retail.data)
factor.cols <- c("InvoiceNo", "StockCode", "CustomerID", "Country")
retail.data[, factor.cols] <- lapply(retail.data[factor.cols], as.factor)
str(retail.data)
library(lubridate)
retail.data$InvoiceDate <- mdy_hm(retail.data$InvoiceDate)
str(retail.data)
View(retail.data)
retail.data <- read.csv("data/OnlineRetail.csv", stringsAsFactors = FALSE)
factor.cols <- c("InvoiceNo", "StockCode", "CustomerID", "Country")
retail.data[, factor.cols] <- lapply(retail.data[factor.cols], as.factor)
date.cols <- c("InvoiceDate")
retail.data[, date.cols] <- lapply(retail.data[date.cols], mdy_hm)
str(retail.data)
View(retail.data)
library(reshape2)
zz <- retail.data$InvoiceDate[1]
zz
retail.data$day.of.week <- wday(retail.data$InvoiceDate)
retail.data$day.of.month <- mday(retail.data$InvoiceDate)
retail.data$month <- month(retail.data$InvoiceDate)
View(retail.data)
seasonal.bins <- 1:12
seasonal.bins <- data.frame(month = 1:12, season = "summer")
View(seasonal.bins)
retail.data$year <- year(retail.data$InvoiceDate)
zz <- group_by(retail.data, StockCode)
View(zz)
summarise(zz,
orders = n_distinct(InvoiceNo),
customers = n_distinct(CustomerID),
volume = sum(Quantity))
zz <- group_by(retail.data, StockCode)
zz.summary <- summarise(zz,
orders = n_distinct(InvoiceNo),
customers = n_distinct(CustomerID),
volume = sum(Quantity))
View(zz.summary)
hist(zz.summary$volume)
filter(retail.data, CustomerID == 12346)
grep("C", retail.data$InvoiceNo)
?grep
grep("C", as.character(retail.data$InvoiceNo))
?gsub
order.data$BaseInvoiceNo <- gsub("c", "", order.data$InvoiceNo)
order.data <- retail.data
order.data$return <- 0
return.index <- grep("c", order.data$InvoiceNo, ignore.case = TRUE)
order.data$return[return.index] <- 1
order.data$BaseInvoiceNo <- gsub("c", "", order.data$InvoiceNo)
View(order.data)
order.data$BaseInvoiceNo <- gsub("c", "", order.data$InvoiceNo, ignore.case = TRUE)
str(retail.data)
return.columns <- c("InvoiceNo", "StockCode", "Quantity")
order.data <- retail.data
return.index <- grep("c", order.data$InvoiceNo, ignore.case = TRUE)
return.data <- order.data[return.index, return.columns]
return.data$BaseInvoiceNo <- gsub("c", "", return.data$InvoiceNo, ignore.case = TRUE)
View(return.data)
View(order.data)
View(zz.summary)
View(return.data)
?merge
return.data$BaseInvoiceNo <- gsub("c", "", return.data$InvoiceNo, ignore.case = TRUE) %>% as.factor()
return.data$InvoiceNo <- gsub("c", "", return.data$InvoiceNo, ignore.case = TRUE) %>% as.factor()
zz <- merge(return.data, order.data, by = c("InvoiceNo", "StockCode"))
?combine
return.data$CompKey <- paste(return.data$InvoiceNo, return.data$StockCode)
return.data$CompKey <- paste(return.data$InvoiceNo, return.data$StockCode, sep = "")
order.data$CompKey <- paste(order.data$InvoiceNo, order.data$StockCode, sep = "")
colnames(return.data$Quantity) <- "ReturnQuantity"
zz <- merge(return.data, order.data, by = CompKey)
return.columns <- c("InvoiceNo", "StockCode", "Quantity")
return.index <- grep("c", order.data$InvoiceNo, ignore.case = TRUE)
return.data <- order.data[return.index, return.columns]
# Remove "c" from Invoice Number to merge
return.data$InvoiceNo <- gsub("c", "", return.data$InvoiceNo, ignore.case = TRUE) %>% as.factor()
# Create composite key
return.data$CompKey <- paste(return.data$InvoiceNo, return.data$StockCode, sep = "")
order.data$CompKey <- paste(order.data$InvoiceNo, order.data$StockCode, sep = "")
zz <- merge(return.data, order.data, by = CompKey)
zz <- merge(return.data, order.data, by = "CompKey")
?merge
str(order.data)
str(return.data)
?cbind
which(order.data$CompKey %in% return.data$CompKey)
order.data$CompKey %in% return.data$CompKey
intersect(names(order.data), names(return.data))
View(zz)
x.list <- order.data$CompKey
y.list <- return.data$CompKey
x.list
y.list %in% x.list
which(x.list %in% y.list)
View(order.data)
filter(order.data, InvoiceNo = "536391")
filter(order.data, InvoiceNo == "536391")
filter(order.data, InvoiceNo == 536391)
return.columns <- c("InvoiceNo", "StockCode", "Quantity")
return.index <- grep("c", order.data$InvoiceNo, ignore.case = TRUE)
return.data <- order.data[return.index, return.columns]
filter(order.data, InvoiceNo == "C581569")
filter(order.data, InvoiceNo == "581569")
y.list <- return.data$InvoiceNo
which(x.list %in% y.list)
y.list
x.list
x.list <- order.data$InvoiceNo
which(x.list %in% y.list)
return.data$InvoiceNo <- gsub("c", "", return.data$InvoiceNo, ignore.case = TRUE) %>% as.factor()
y.list <- return.data$InvoiceNo
which(x.list %in% y.list)
filter(order.data, CustomerID == "12346")
return.columns <- c("InvoiceNo", "StockCode", "CustomerID", "Quantity")
return.index <- grep("c", order.data$InvoiceNo, ignore.case = TRUE)
return.data <- order.data[return.index, return.columns]
NA.names <- order.data %>% filter(CustomerID == NA) %>% nrow()
NA.names <- order.data %>% filter(CustomerID == "NA") %>% nrow()
order.data %>% filter(CustomerID == "NA") %>% nrow()
order.data %>% filter(CustomerID == NULL) %>% nrow()
order.data %>% filter(CustomerID == NULL)
order.data %>% filter(is.na(CustomerID))
order.data %>% filter(is.na(CustomerID)) %>% nrow()
retail.data <- retail.data %>% filter(!is.na(CustomerID))
order.data <- retail.data
order.data %>% filter(CustomerID == "12921")
zz <- order.data %>% filter(CustomerID == "12921")
View(zz)
SKU.groups <- group_by(retail.data, StockCode)
SKU.summary <- summarise(SKU.groups,
orders = n_distinct(InvoiceNo),
customers = n_distinct(CustomerID),
volume = sum(Quantity))
View(SKU.summary)
str(retail.data)
daily.summary <- summarise(group_by(retail.data, day.of.week),
orders = n_distinct(InvoiceNo),
customers = n_distinct(CustomerID),
volume = sum(Quantity),
contibution = sum(Quantity * UnitPrice))
View(daily.summary)
SKU.summary <- summarise(group_by(retail.data, StockCode),
orders = n_distinct(InvoiceNo),
customers = n_distinct(CustomerID),
volume = sum(Quantity),
contribution = sum(Quantity * UnitPrice))
## Group_bys
f_basic_summary <- function(order.data, grouper) {
current.summary <- summarise(group_by(order.data, grouper),
orders = n_distinct(InvoiceNo),
customers = n_distinct(CustomerID),
volume = sum(Quantity),
contribution = sum(Quantity * UnitPrice))
return(current.summary)
}
SKU.summary <- f_basic_summary(retail.data, StockCode)
grouper = StockCode
daily.summary <- summarise(group_by(retail.data, "day.of.week"),
orders = n_distinct(InvoiceNo),
customers = n_distinct(CustomerID),
volume = sum(Quantity),
contibution = sum(Quantity * UnitPrice))
SKU.summary <- f_basic_summary(retail.data, "StockCode")
## Group_bys
f_basic_summary <- function(order.data, grouper) {
current.summary <- summarise(group_by(order.data, grouper),
orders = n_distinct(InvoiceNo),
customers = n_distinct(CustomerID),
volume = sum(Quantity),
contribution = sum(Quantity * UnitPrice))
return(current.summary)
}
# SKU popularity
SKU.summary <- f_basic_summary(retail.data, "StockCode")
## Group_bys
f_basic_summary <- function(order.data, grouper) {
print(grouper)
current.summary <- summarise(group_by(order.data, grouper),
orders = n_distinct(InvoiceNo),
customers = n_distinct(CustomerID),
volume = sum(Quantity),
contribution = sum(Quantity * UnitPrice))
return(current.summary)
}
# SKU popularity
SKU.summary <- f_basic_summary(retail.data, "StockCode")
grouper = "StockCode"
substitute(grouper)
grouper
daily.summary <- summarise(group_by(retail.data, "day.of.week"),
orders = n_distinct(InvoiceNo),
customers = n_distinct(CustomerID),
volume = sum(Quantity),
contibution = sum(Quantity * UnitPrice))
View(daily.summary)
# Trends by day of week
daily.summary <- summarise(group_by(retail.data, day.of.week),
orders = n_distinct(InvoiceNo),
customers = n_distinct(CustomerID),
volume = sum(Quantity),
contibution = sum(Quantity * UnitPrice))
View(daily.summary)
class(day.of.week)
c(a, b)
zz <- retail.data %>% group_by("StockCode")
zz <- retail.data %>% group_by("StockCode") %>% summarise()
zz
zz <- retail.data %>% group_by(StockCode) %>% summarise()
zz
SKU.summary <- f_basic_summary(group_by(retail.data, "StockCode"))
## Group_bys
f_basic_summary <- function(grouped.data) {
current.summary <- summarise(grouped.data,
orders = n_distinct(InvoiceNo),
customers = n_distinct(CustomerID),
volume = sum(Quantity),
contribution = sum(Quantity * UnitPrice))
return(current.summary)
}
# SKU popularity
SKU.summary <- f_basic_summary(group_by(retail.data, "StockCode"))
View(SKU.summary)
SKU.summary <- f_basic_summary(group_by(retail.data, StockCode))
View(SKU.summary)
str(retail.data)
daily.summary <- f_basic_summary(group_by(retail.data, day.of.month))
daily.summary <- f_basic_summary(group_by(retail.data, day.of.week))
day.of.month.summary <- f_basic_summary(group_by(retail.data, day.of.month))
View(day.of.month.summary)
retail.data$week.of.month <- mweek(retail.data$InvoiceDate)
retail.data$day.of.week <- wday(retail.data$InvoiceDate, label = TRUE)
daily.summary <- f_basic_summary(group_by(retail.data, day.of.week))
View(daily.summary)
monthly.summary <- f_basic_summary(group_by(retail.data, month))
View(monthly.summary)
retail.data$month <- month(retail.data$InvoiceDate, label = TRUE)
monthly.summary <- f_basic_summary(group_by(retail.data, month))
View(monthly.summary)
qplot(monthly.summary, x = month, y = orders)
library(ggplot2)
qplot(monthly.summary, x = month, y = orders)
qplot(monthly.summary$month, monthly.summary$orders)
qplot(monthly.summary$month, monthly.summary$customers)
qplot(monthly.summary$month, monthly.summary$volume)
qplot(monthly.summary$month, monthly.summary$contribution)
customer.summary <- f_basic_summary(group_by(retail.data, CustomerID))
View(customer.summary)
hist(customer.summary$orders)
hist(customer.summary$orders, breaks = 30)
hist(customer.summary$orders, breaks = 50)
?qplot
qplot(x = orders, y = volume, data = customer.summary)
qplot(x = orders, y = contribution, data = customer.summary)
qplot(x = volume, y = contribution, data = customer.summary)
View(SKU.summary)
qplot(x = orders, y = volume, data = SKU.summary)
qplot(x = orders, y = contribution, data = SKU.summary)
customer.summary <- f_basic_summary(group_by(retail.data, CustomerID, StockCode))
customer.summary <- f_basic_summary(group_by(retail.data, CustomerID))
customer.SKU.summary <- f_basic_summary(group_by(retail.data, CustomerID, StockCode))
View(customer.SKU.summary)
str(retail.data)
region.summary <- f_basic_summary(group_by(retail.data, Country))
View(region.summary)
region.SKU.summary <- f_basic_summary(group_by(retail.data, Country, StockCode))
View(region.SKU.summary)
View(retail.data)
monthly.SKU.summary <- f_basic_summary(group_by(retail.data, month, StockCode))
View(monthly.SKU.summary)
monthly.SKU.summary <- f_basic_summary(group_by(retail.data, StockCode, month))
View(monthly.SKU.summary)
